<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Fall Detection System</title>
    
    <!-- MediaPipe & FontAwesome -->
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/pose/pose.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js"></script>
    
    <!-- Styles -->
    <style>
        :root {
            --primary: #4361ee;
            --success: #4cc9f0;
            --danger: #f72585;
            --dark: #212529;
            --light: #f8f9fa;
            --background: #f5f7fa;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: Arial, sans-serif; background-color: var(--background); color: #333; min-height: 100vh; text-align: center; }
        
        .container { max-width: 1000px; margin: auto; padding: 20px; }
        
        h1 { color: var(--primary); margin-bottom: 10px; }
        .subtitle { font-size: 1.1rem; color: #555; margin-bottom: 20px; }
        
        .video-container {
            position: relative; display: flex; justify-content: center; align-items: center;
            background-color: #000; border-radius: 8px; overflow: hidden;
        }

        video, canvas { width: 100%; border-radius: 8px; }
        
        .controls { margin-top: 15px; display: flex; justify-content: center; gap: 10px; }
        
        .btn {
            padding: 10px 20px; border: none; border-radius: 5px; font-size: 1rem;
            cursor: pointer; display: flex; align-items: center; gap: 8px;
        }
        
        .btn-primary { background: var(--primary); color: white; }
        .btn-primary:hover { background: #3a56e8; }
        .btn-outline { border: 2px solid var(--primary); color: var(--primary); background: none; }
        .btn-outline:hover { background: rgba(67, 97, 238, 0.1); }

        .status-box {
            margin-top: 20px; padding: 15px; border-radius: 8px;
            font-size: 1.2rem; font-weight: bold;
        }

        .safe { background: rgba(76, 201, 240, 0.1); border: 2px solid var(--success); }
        .danger { background: rgba(247, 37, 133, 0.1); border: 2px solid var(--danger); animation: pulse 1.5s infinite; }

        @keyframes pulse {
            0% { box-shadow: 0 0 0 0 rgba(247, 37, 133, 0.4); }
            70% { box-shadow: 0 0 0 10px rgba(247, 37, 133, 0); }
            100% { box-shadow: 0 0 0 0 rgba(247, 37, 133, 0); }
        }

        .stats { display: flex; justify-content: space-around; margin-top: 15px; }
        
        .footer { margin-top: 30px; font-size: 0.9rem; color: #666; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Smart Fall Detection System</h1>
        <p class="subtitle">AI-powered real-time fall detection</p>

        <div class="video-container">
            <video id="video" autoplay playsinline></video>
            <canvas id="canvas"></canvas>
        </div>

        <div class="controls">
            <button id="startButton" class="btn btn-primary">
                <i class="fas fa-play"></i> Start Monitoring
            </button>
            <button id="helpButton" class="btn btn-outline">
                <i class="fas fa-question-circle"></i> Help
            </button>
        </div>

        <div id="statusBox" class="status-box safe">
            <span id="statusText">No falls detected</span>
        </div>

        <div class="stats">
            <div><strong>Uptime:</strong> <span id="uptime">00:00:00</span></div>
            <div><strong>Falls Detected:</strong> <span id="fallCount">0</span></div>
        </div>

        <p class="footer">&copy; 2025 Smart AI System</p>
    </div>

    <script>
        const video = document.getElementById("video");
        const canvas = document.getElementById("canvas");
        const ctx = canvas.getContext("2d");

        const startButton = document.getElementById("startButton");
        const statusBox = document.getElementById("statusBox");
        const statusText = document.getElementById("statusText");
        const uptimeElement = document.getElementById("uptime");
        const fallCountElement = document.getElementById("fallCount");

        let fallCount = 0;
        let startTime = null;
        let uptimeInterval = null;

        async function setupCamera() {
            const stream = await navigator.mediaDevices.getUserMedia({ video: true });
            video.srcObject = stream;

            return new Promise(resolve => {
                video.onloadedmetadata = () => {
                    canvas.width = video.videoWidth;
                    canvas.height = video.videoHeight;
                    resolve();
                };
            });
        }

        function calculateBodyAngle(landmarks) {
            const leftShoulder = landmarks[11];
            const rightShoulder = landmarks[12];
            const leftHip = landmarks[23];
            const rightHip = landmarks[24];

            const shoulderMid = { x: (leftShoulder.x + rightShoulder.x) / 2, y: (leftShoulder.y + rightShoulder.y) / 2 };
            const hipMid = { x: (leftHip.x + rightHip.x) / 2, y: (leftHip.y + rightHip.y) / 2 };

            return Math.atan2(hipMid.y - shoulderMid.y, hipMid.x - shoulderMid.x) * (180 / Math.PI);
        }

        function updateUptime() {
            const elapsed = Math.floor((Date.now() - startTime) / 1000);
            uptimeElement.textContent = new Date(elapsed * 1000).toISOString().substr(11, 8);
        }

        function detectFall(angle) {
            if (Math.abs(angle) > 50) {
                statusBox.className = "status-box danger";
                statusText.textContent = "Fall detected!";
                fallCount++;
                fallCountElement.textContent = fallCount;
            } else {
                statusBox.className = "status-box safe";
                statusText.textContent = "No falls detected";
            }
        }

        async function startMonitoring() {
            await setupCamera();
            startTime = Date.now();
            uptimeInterval = setInterval(updateUptime, 1000);
            requestAnimationFrame(detectPose);
        }

        function detectPose() {
            // AI Pose detection logic here...
            requestAnimationFrame(detectPose);
        }

        startButton.addEventListener("click", startMonitoring);
    </script>
</body>
</html>